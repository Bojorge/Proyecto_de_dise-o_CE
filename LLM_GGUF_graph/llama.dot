digraph G {
  newrank = true;
  rankdir = LR;
  "0x7f976887b180" [ style = filled; fillcolor = white; shape = record; label="inp_tokens (view) (i32)|0 [1, 1] | <x>view(x)"; ]
  "0x7f976887b310" [ style = filled; fillcolor = white; shape = record; label="inp_embd (f32)|1 [4096, 1] | <x>get_rows(x)"; ]
  "0x7f976887b7c0" [ style = filled; fillcolor = white; shape = record; label="norm-0 (f32)|2 [4096, 1] | <x>rms_norm(x)"; ]
  "0x7f976887b950" [ style = filled; fillcolor = white; shape = record; label="attn_norm-0 (f32)|3 [4096, 1] | <x>x*y"; ]
  "0x7f976887bae0" [ style = filled; fillcolor = white; shape = record; label="Qcur-0 (f32)|4 [4096, 1] | <x>X*Y"; ]
  "0x7f976887bf90" [ style = filled; fillcolor = white; shape = record; label="Qcur-0 (reshaped) (f32)|5 [128, 32] | <x>reshape(x)"; ]
  "0x7f976887b4a0" [ style = filled; fillcolor = white; shape = record; label="inp_pos (i32)|6 [1, 1] | <x>view(x)"; ]
  "0x7f976887c120" [ style = filled; fillcolor = white; shape = record; label="Qcur-0 (f32)|7 [128, 32] | <x>rope(x)"; ]
  "0x7f976887bc70" [ style = filled; fillcolor = white; shape = record; label="Kcur-0 (f32)|8 [4096, 1] | <x>X*Y"; ]
  "0x7f976887c2b0" [ style = filled; fillcolor = white; shape = record; label="Kcur-0 (reshaped) (f32)|9 [128, 32] | <x>reshape(x)"; ]
  "0x7f976887c440" [ style = filled; fillcolor = white; shape = record; label="Kcur-0 (f32)|10 [128, 32] | <x>rope(x)"; ]
  "0x7f976887be00" [ style = filled; fillcolor = white; shape = record; label="Vcur-0 (f32)|11 [4096, 1] | <x>X*Y"; ]
  "0x7f976887c8f0" [ style = filled; fillcolor = white; shape = record; label="k_cache_view-0 (f16)|12 [4096, 1] | <x>view(x)"; ]
  "0x7f976887cc10" [ style = filled; fillcolor = white; shape = record; label="k_cache_view-0 (copy of Kcur-0) (f16)|13 [4096, 1] | <x>x-\>y"; ]
  "0x7f976887c5d0" [ style = filled; fillcolor = white; shape = record; label="Vcur-0 (reshaped) (f32)|14 [4096, 1] | <x>reshape(x)"; ]
  "0x7f976887c760" [ style = filled; fillcolor = white; shape = record; label="v_cur_t-0 (f32)|15 [1, 4096] | <x>transpose(x)"; ]
  "0x7f976887ca80" [ style = filled; fillcolor = white; shape = record; label="v_cache_view-0 (f16)|16 [1, 4096] | <x>view(x)"; ]
  "0x7f976887cda0" [ style = filled; fillcolor = white; shape = record; label="v_cache_view-0 (copy of v_cur_t-0) (f16)|17 [1, 4096] | <x>x-\>y"; ]
  "0x7f976887d570" [ style = filled; fillcolor = white; shape = record; label="v-0 (f16)|18 [128, 128, 32] | <x>view(x)"; ]
  "0x7f976887d0c0" [ style = filled; fillcolor = white; shape = record; label="k-0 (f16)|19 [128, 128, 32] | <x>view(x)"; ]
  "0x7f976887cf30" [ style = filled; fillcolor = white; shape = record; label="q-0 (f32)|20 [128, 1, 32] | <x>permute(x)"; ]
  "0x7f976887d250" [ style = filled; fillcolor = white; shape = record; label="kq-0 (f32)|21 [128, 1, 32] | <x>X*Y"; ]
  "0x7f976887b630" [ style = filled; fillcolor = white; shape = record; label="KQ_mask (f32)|22 [128, 1] | <x>view(x)"; ]
  "0x7f976887d3e0" [ style = filled; fillcolor = white; shape = record; label="kq_soft_max_ext-0 (f32)|23 [128, 1, 32] | <x>soft_max(x)"; ]
  "0x7f976887d700" [ style = filled; fillcolor = white; shape = record; label="kqv-0 (f32)|24 [128, 1, 32] | <x>X*Y"; ]
  "0x7f976887d890" [ style = filled; fillcolor = white; shape = record; label="kqv_merged-0 (f32)|25 [128, 32] | <x>permute(x)"; ]
  "0x7f976887da20" [ style = filled; fillcolor = white; shape = record; label="kqv_merged_cont-0 (f32)|26 [4096, 1] | <x>cont(x)"; ]
  "0x7f976887dbb0" [ style = filled; fillcolor = white; shape = record; label="kqv_out-0 (f32)|27 [4096, 1] | <x>X*Y"; ]
  "0x7f976887dd40" [ style = filled; fillcolor = white; shape = record; label="ffn_inp-0 (f32)|28 [4096, 1] | <x>x+y"; ]
  "0x7f976887ded0" [ style = filled; fillcolor = white; shape = record; label="norm-0 (f32)|29 [4096, 1] | <x>rms_norm(x)"; ]
  "0x7f976887e060" [ style = filled; fillcolor = white; shape = record; label="ffn_norm-0 (f32)|30 [4096, 1] | <x>x*y"; ]
  "0x7f976887e380" [ style = filled; fillcolor = white; shape = record; label="ffn_gate-0 (f32)|31 [11008, 1] | <x>X*Y"; ]
  "0x7f976887e510" [ style = filled; fillcolor = white; shape = record; label="ffn_silu-0 (f32)|32 [11008, 1] | <x>unary(x)"; ]
  "0x7f976887e1f0" [ style = filled; fillcolor = white; shape = record; label="ffn_up-0 (f32)|33 [11008, 1] | <x>X*Y"; ]
  "0x7f976887e6a0" [ style = filled; fillcolor = white; shape = record; label="ffn_gate_par-0 (f32)|34 [11008, 1] | <x>x*y"; ]
  "0x7f976887e830" [ style = filled; fillcolor = white; shape = record; label="ffn_out-0 (f32)|35 [4096, 1] | <x>X*Y"; ]
  "0x7f976887e9c0" [ style = filled; fillcolor = white; shape = record; label="l_out-0 (f32)|36 [4096, 1] | <x>x+y"; ]
  "0x7f976887eb50" [ style = filled; fillcolor = white; shape = record; label="norm (f32)|37 [4096, 1] | <x>rms_norm(x)"; ]
  "0x7f976887ece0" [ style = filled; fillcolor = white; shape = record; label="result_norm (f32)|38 [4096, 1] | <x>x*y"; ]
  "0x7f976887ee70" [ style = filled; fillcolor = white; shape = record; label="result_output (f32)|39 [32001, 1] | <x>X*Y"; ]
  "0x564881def180" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.attn_q.weight (q2_K)|CONST 0 [4096, 4096]"; ]
  "0x564881deeb40" [ style = filled; fillcolor = pink; shape = record; label="<x>token_embd.weight (q2_K)|CONST 1 [4096, 32001]"; ]
  "0x564881a449a0" [ style = filled; fillcolor = pink; shape = record; label="<x>inp_tokens (i32)|CONST 2 [512, 1]"; ]
  "0x564881deeff0" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.attn_norm.weight (f32)|CONST 3 [4096, 1]"; ]
  "0x564881a44cc0" [ style = filled; fillcolor = pink; shape = record; label="<x>inp_pos (i32)|CONST 4 [512, 1]"; ]
  "0x564881def310" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.attn_k.weight (q2_K)|CONST 5 [4096, 4096]"; ]
  "0x564881def4a0" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.attn_v.weight (q3_K)|CONST 6 [4096, 4096]"; ]
  "0x564881a4d9d0" [ style = filled; fillcolor = pink; shape = record; label="<x>cache_k_l0 (f16)|CONST 7 [2097152, 1]"; ]
  "0x564881a4db60" [ style = filled; fillcolor = pink; shape = record; label="<x>cache_v_l0 (f16)|CONST 8 [2097152, 1]"; ]
  "0x564881a44e50" [ style = filled; fillcolor = pink; shape = record; label="<x>inp_KQ_mask (f32)|CONST 9 [512, 512]"; ]
  "0x564881deee60" [ style = filled; fillcolor = pink; shape = record; label="<x>output.weight (q6_K)|CONST 10 [4096, 32001]"; ]
  "0x564881defae0" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.ffn_down.weight (q3_K)|CONST 11 [11008, 4096]"; ]
  "0x564881def950" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.ffn_gate.weight (q3_K)|CONST 12 [4096, 11008]"; ]
  "0x564881def630" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.attn_output.weight (q3_K)|CONST 13 [4096, 4096]"; ]
  "0x564881def7c0" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.ffn_norm.weight (f32)|CONST 14 [4096, 1]"; ]
  "0x564881defc70" [ style = filled; fillcolor = pink; shape = record; label="<x>blk.0.ffn_up.weight (q3_K)|CONST 15 [4096, 11008]"; ]
  "0x564881deecd0" [ style = filled; fillcolor = pink; shape = record; label="<x>output_norm.weight (f32)|CONST 16 [4096, 1]"; ]
  "0x564881a449a0":x -> "0x7f976887b180":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881deeb40":x -> "0x7f976887b310":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b180":x -> "0x7f976887b310":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887b310":x -> "0x7f976887b7c0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b7c0":x -> "0x7f976887b950":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881deeff0":x -> "0x7f976887b950":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881def180":x -> "0x7f976887bae0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b950":x -> "0x7f976887bae0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887bae0":x -> "0x7f976887bf90":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881a44cc0":x -> "0x7f976887b4a0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887bf90":x -> "0x7f976887c120":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b4a0":x -> "0x7f976887c120":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881def310":x -> "0x7f976887bc70":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b950":x -> "0x7f976887bc70":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887bc70":x -> "0x7f976887c2b0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887c2b0":x -> "0x7f976887c440":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b4a0":x -> "0x7f976887c440":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881def4a0":x -> "0x7f976887be00":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b950":x -> "0x7f976887be00":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881a4d9d0":x -> "0x7f976887c8f0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887c440":x -> "0x7f976887cc10":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887c8f0":x -> "0x7f976887cc10":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887be00":x -> "0x7f976887c5d0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887c5d0":x -> "0x7f976887c760":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881a4db60":x -> "0x7f976887ca80":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887c760":x -> "0x7f976887cda0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887ca80":x -> "0x7f976887cda0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881a4db60":x -> "0x7f976887d570":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881a4d9d0":x -> "0x7f976887d0c0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887c120":x -> "0x7f976887cf30":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887d0c0":x -> "0x7f976887d250":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887cf30":x -> "0x7f976887d250":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881a44e50":x -> "0x7f976887b630":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887d250":x -> "0x7f976887d3e0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b630":x -> "0x7f976887d3e0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887d570":x -> "0x7f976887d700":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887d3e0":x -> "0x7f976887d700":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887d700":x -> "0x7f976887d890":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887d890":x -> "0x7f976887da20":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881def630":x -> "0x7f976887dbb0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887da20":x -> "0x7f976887dbb0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887dbb0":x -> "0x7f976887dd40":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887b310":x -> "0x7f976887dd40":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887dd40":x -> "0x7f976887ded0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887ded0":x -> "0x7f976887e060":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881def7c0":x -> "0x7f976887e060":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881def950":x -> "0x7f976887e380":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887e060":x -> "0x7f976887e380":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887e380":x -> "0x7f976887e510":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881defc70":x -> "0x7f976887e1f0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887e060":x -> "0x7f976887e1f0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887e510":x -> "0x7f976887e6a0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887e1f0":x -> "0x7f976887e6a0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881defae0":x -> "0x7f976887e830":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887e6a0":x -> "0x7f976887e830":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887e830":x -> "0x7f976887e9c0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887dd40":x -> "0x7f976887e9c0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x7f976887e9c0":x -> "0x7f976887eb50":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887eb50":x -> "0x7f976887ece0":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x564881deecd0":x -> "0x7f976887ece0":x [ arrowhead = vee; style = solid; label = "src 1"; ]
  "0x564881deee60":x -> "0x7f976887ee70":x [ arrowhead = vee; style = solid; label = "src 0"; ]
  "0x7f976887ece0":x -> "0x7f976887ee70":x [ arrowhead = vee; style = solid; label = "src 1"; ]
}
